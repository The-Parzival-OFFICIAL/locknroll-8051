A51 MACRO ASSEMBLER  MOTOR_TEST_CODE                                                      03/11/2025 21:59:00 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\MOTOR_TEST CODE.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE MOTOR_TEST CODE.a51 SET(SMALL) DEBUG PRINT(.\Listings\MOTOR_TEST CODE.l
                      st) OBJECT(.\Objects\MOTOR_TEST CODE.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     
                       2     ;//TODO: 
                       3     ;  check if enable is shorted in the circuit else:
                       4     ;   add enable line code in the belo code 
                       5     
                       6     
                       7     
                       8     
                       9     
                      10     
                      11     ;-------------------------------------
                      12     ; PORT CONNECTION MAP 
                      13     ;-------------------------------------
                      14     ; PORT 2 IS ASSIGNED TO MOTOR FOR NOW 
                      15     ;  ----------------------------
                      16     ; | PORT IN MC |   PIN  IN     | 
                      17     ; | / OTR CNN  |    LM293D     |
                      18     ; |------------|---------------|
                      19     ; |PORT 2.0    |EN1/2 (PIN 1)  |
                      20     ; |PORT 2.1    |IN1 (PIN 2)    |
                      21     ; |PORT 2.2    |IN2 (PIN 7)    |
                      22     ; |MTR TERM 1  |OUT1 (PIN 3)   |
                      23     ; |MTR TERM 2  |OUT2 (PIN 6)   |
                      24     ;  ---------------------------- 
0000                  25     ORG 0000H
                      26     ;------------------------------------------
                      27     ;  defined constants 
                      28     ;------------------------------------------
0000 1C               29     MOTOR_DELAY: DB 28;  multiple of 14 to add seconds delay ; 1 here is 0.0711 seconds
0001 8060             30             SJMP START
0030                  31     ORG 0030H;
                      32             ; ROTATE THE MOTOR FOR SOME DELAY THAT SETS IT TO 
                      33             ; 90 DEGREE OR ANY OTHER ANGLE BY ADJUSTING TIME 
0030                  34             OPEN_LOCK: 
0030 C2A2             35                     CLR P2.2
0032 D2A1             36                     SETB P2.1 ; PORT CONNECTED TO IN1 OF LM
0034 900000           37                     MOV DPTR , #MOTOR_DELAY
0037 1144             38                     ACALL DELAY
0039 22               39                     RET
                      40                     
003A                  41             CLOSE_LOCK:
003A C2A1             42                     CLR P2.1
003C D2A2             43                     SETB P2.2
003E 900000           44                     MOV DPTR, #MOTOR_DELAY
0041 1144             45                     ACALL DELAY
0043 22               46                     RET
                      47                     
0044                  48             DELAY: 
0044 E4               49                     CLR A
0045 93               50                     MOVC A , @A+DPTR
0046 FF               51                     MOV R7, A
0047                  52             LOOP_1:
0047 114E             53                     ACALL FU_DELAY
0049 1F               54                     DEC R7;
004A BF00FA           55                     CJNE R7,#00,LOOP_1;
004D 22               56                     RET
                      57                     
A51 MACRO ASSEMBLER  MOTOR_TEST_CODE                                                      03/11/2025 21:59:00 PAGE     2

004E                  58             FU_DELAY:
004E 758910           59                     MOV TMOD , #00010000B
0051 7400             60                     MOV A,#00
0053 F58D             61                     MOV TH1,A
0055 7400             62                     MOV A,#00
0057 F58B             63                     MOV TL1,A
0059 D28E             64                     SETB TR1
005B 308FFD           65                     STOP: JNB TF1, STOP
005E C28E             66                     CLR TR1
0060 C28F             67                     CLR TF1
0062 22               68                     RET
                      69                     
0063                  70             START: 
0063 1130             71                     ACALL OPEN_LOCK;
0065 113A             72                     ACALL CLOSE_LOCK; 
                      73                     ;SJMP START;
                      74                     END
                                             
                                             
A51 MACRO ASSEMBLER  MOTOR_TEST_CODE                                                      03/11/2025 21:59:00 PAGE     3

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

CLOSE_LOCK . . . .  C ADDR   003AH   A   
DELAY. . . . . . .  C ADDR   0044H   A   
FU_DELAY . . . . .  C ADDR   004EH   A   
LOOP_1 . . . . . .  C ADDR   0047H   A   
MOTOR_DELAY. . . .  C ADDR   0000H   A   
OPEN_LOCK. . . . .  C ADDR   0030H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
START. . . . . . .  C ADDR   0063H   A   
STOP . . . . . . .  C ADDR   005BH   A   
TF1. . . . . . . .  B ADDR   0088H.7 A   
TH1. . . . . . . .  D ADDR   008DH   A   
TL1. . . . . . . .  D ADDR   008BH   A   
TMOD . . . . . . .  D ADDR   0089H   A   
TR1. . . . . . . .  B ADDR   0088H.6 A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
