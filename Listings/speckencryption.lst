A51 MACRO ASSEMBLER  SPECKENCRYPTION                                                      03/11/2025 19:50:27 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\speckencryption.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE speckencryption.a51 SET(SMALL) DEBUG PRINT(.\Listings\speckencryption.l
                      st) OBJECT(.\Objects\speckencryption.obj) EP

LOC  OBJ            LINE     SOURCE

0000                   1     ORG 0000H
0000 802E              2             SJMP START
                       3     
                       4     
0030                   5     ORG 0030H
                       6     
                       7     ; Registers Usage:
                       8     ; R0, R1 -> Left half (L)
                       9     ; R2, R3 -> Right half (R)
                      10     ; R4, R5 -> Round Key (Ki)
                      11     ; R6, R7 -> Temporary values
                      12     
                      13     
0030                  14     START: 
0030 900072           15             MOV DPTR , #KEY
0033 7800             16             MOV R0 , #00H
0035 7900             17             MOV R1 , #00H
0037 7A00             18             MOV R2 , #00H 
0039 7B00             19             MOV R3 , #00H
                      20     ;------------------------------------------------------------------------------------------
                             ---------
                      21     ;       shit to be encoded 
                      22     ;------------------------------------------------------------------------------------------
                             ---------
003B 7812             23             MOV R0, #12H   ; L = 0x1234 (Left half of plaintext)
003D 7934             24             MOV R1, #34H
003F 7A56             25             MOV R2, #56H   ; R = 0x5678 (Right half of plaintext)
0041 7B78             26             MOV R3, #78H
                      27             
0043 116D             28             CALL KEY_EXPANSION 
0045 1149             29             CALL ENCRYPTION 
0047 80FE             30             SJMP $ 
                      31     ;------------------------------------------------------------------------------------------
                             ----------
                      32     ;-----------------------------
                      33     ; SPECK 32/64 ENCRYPTION 
                      34     ;-----------------------------
                      35     
0049                  36     ENCRYPTION:
0049 7E20             37             MOV R6, #32 ; number of rounds for 32/64 is 22 
004B                  38             ENC_LOOP:
004B 1166             39                     CALL LOAD_ROUND_KEY
004D 1152             40                     CALL ROUND_FUNCTION 
004F DEFA             41                     DJNZ R6 , ENC_LOOP
0051 22               42                     RET
                      43     ;------------------------------
                      44     ; SPECK ROUND FUNCTION
                      45     ;------------------------------
                      46     
0052                  47     ROUND_FUNCTION:
0052 EB               48             MOV A, R3 
0053 C4               49             SWAP A
0054 FB               50             MOV R3,A
                      51             
0055 EA               52             MOV A,R2
0056 68               53             XRL A,R0
0057 FA               54             MOV R2,A
A51 MACRO ASSEMBLER  SPECKENCRYPTION                                                      03/11/2025 19:50:27 PAGE     2

                      55             
0058 EA               56             MOV A, R2
0059 28               57             ADD A, R0
005A F8               58             MOV R0, A
                      59             
005B E8               60             MOV A , R0 
005C 33               61             RLC A
005D 33               62             RLC A
005E 33               63             RLC A 
005F F8               64             MOV R0, A 
                      65             
0060 E9               66             MOV A , R1
0061 33               67             RLC A 
0062 33               68             RLC A 
0063 33               69             RLC A
0064 F9               70             MOV R1,A 
0065 22               71             RET 
                      72             
                      73             
                      74     ;--------------------------
                      75     ; LOAD ROUND KEY
                      76     ;--------------------------
                      77     
0066                  78     LOAD_ROUND_KEY:
0066 EC               79             MOV A,R4 
0067 6A               80             XRL A, R2
0068 FC               81             MOV R4, A
                      82             
0069 ED               83             MOV A,R5 
006A 6B               84             XRL A, R3
006B FD               85             MOV R5, A
006C 22               86             RET
                      87     ; -------------------------
                      88     ; Key Expansion
                      89     ; -------------------------
006D                  90     KEY_EXPANSION:
006D 7CDE             91         MOV R4, #0DEH            ; Example Key Part 1
006F 7DAD             92         MOV R5, #0ADH            ; Example Key Part 2
0071 22               93         RET
                      94     
                      95     ; -------------------------
                      96     ; Data Section
                      97     ; -------------------------
0072                  98     KEY:
0072 DEADBEEF         99         DB 0DEH, 0ADH, 0BEH, 0EFH, 0CAH, 0FEH , 0BAH , 0BEH ; 64-bit key
0076 CAFEBABE                
                     100     
                     101     END
A51 MACRO ASSEMBLER  SPECKENCRYPTION                                                      03/11/2025 19:50:27 PAGE     3

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

ENCRYPTION . . . .  C ADDR   0049H   A   
ENC_LOOP . . . . .  C ADDR   004BH   A   
KEY. . . . . . . .  C ADDR   0072H   A   
KEY_EXPANSION. . .  C ADDR   006DH   A   
LOAD_ROUND_KEY . .  C ADDR   0066H   A   
ROUND_FUNCTION . .  C ADDR   0052H   A   
START. . . . . . .  C ADDR   0030H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
